<!DOCTYPE html >
<html style="height:100%">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>DataBase Manage</title>


    <link href="static/css/jquery-accordion-menu.css" rel="stylesheet" type="text/css"/>

    <link rel="stylesheet" href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css'>
    <link rel="stylesheet" href="https://cdn.bootcss.com/jqueryui/1.12.1/jquery-ui.min.css"/>
    <!-- Bootstrap core CSS -->
    <link href="static/css/bootstrap-table.min.css" rel="stylesheet">
    <link href="static/css/editor.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="static/css/album.css" rel="stylesheet">
    <link href="static/css/jquery-tab.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.15.5/dist/bootstrap-table.min.css">
    <link href="https://cdn.bootcss.com/toastr.js/latest/css/toastr.min.css" rel="stylesheet">
    <!--    <link href="https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />-->
    <link href="static/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link href="static/css/simsCheckbox.css" rel="stylesheet">
<!--    <link href="http://cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">-->
    <style type="text/css">

        /*#dataTables table tr:hover td { background-color: palegoldenrod; }*/
        .content {
            width: 80%;
            margin: auto;
        }

        .fixed-table-toolbar {
            width: 90%;
            margin: auto;
        }

        /*#toolbar{width:95%}*/
        .jquery-accordion-menu {
            min-width: 0px;
            box-shadow: 0 0px 0px;
            border-radius: 5px;
            border: 1px solid black;
            overflow: auto;
        }

        .jquery-accordion-menu .jquery-accordion-menu-footer, .jquery-accordion-menu .jquery-accordion-menu-header {
            padding-left: 0px;

        }

        .pagination-info {
            margin-left: 50px;
        }

        #demo-list a {
            overflow: hidden;
            text-overflow: ellipsis;
            -o-text-overflow: ellipsis;
            white-space: nowrap;
            width: 100%;
            font-size: 16px;
        }

        .checkbox {
            padding-left: 22px;
            margin-bottom: 16px;
        }

        .bootstrap-table {
            width: 100%;
            margin: auto;
            font-family: PingFangSC-Regular, sans-serif;
        }

        .bootstrap-table .fixed-table-pagination > .pagination ul.pagination a {
            padding: 12px 10px;
        }

        #dataTables {
            border-collapse: separate;
            margin: auto;
            width: 90%;
            background-color: white;
            border-radius: 10px;
            border: 1px solid;
            font-family: PingFangSC-Regular, sans-serif;
        }

        #dataTables thead {
            margin: auto;
        }
    </style>
</head>

<body style="height:100%">


<main role="main" style="height:90%">

    <section class="jumbotron text-center" style="float: left; text-align: center; width: 20%;" id="db_nav">
        <div class="container">
            <h1 class="jumbotron-heading">DataBase Manage</h1>
            <p class="lead text-muted">管理yangcx数据库的所有数据表</p>
            <p>
                <a href="http://106.54.91.157:90/phpmyadmin" class="btn btn-primary my-2">phpMyAdmin</a>
            </p>
            <div id="jquery-accordion-menu" class="jquery-accordion-menu white my-4">
                <div class="jquery-accordion-menu-header" id="form">Table Name</div>
                <ul id="demo-list"></ul>
            </div>
        </div>

    </section>
    <header>
        <!--      <div class="navbar navbar-dark bg-dark box-shadow">-->
        <!--          <div class="container">-->
        <!--&lt;!&ndash;        <div class="container d-flex justify-content-start">&ndash;&gt;-->
        <!--&lt;!&ndash;          <a href="#" class="navbar-brand align-items-center d-flex">&ndash;&gt;-->
        <!--&lt;!&ndash;            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>&ndash;&gt;-->
        <!--            <a href="#" class="navbar-brand" style="float:left">-->
        <!--            <strong>数据库管理</strong>-->
        <!--          </a>-->
        <!--        </div>-->
        <!--      </div>-->
        <nav class="navbar navbar-expand-md navbar-dark bg-dark  box-shadow">
            <a class="navbar-brand" href="#"><strong>数据库管理系统</strong></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
                    aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav mr-auto">
                </ul>
                <form class="form-inline mt-2 mt-md-0">
                    <i class="fa fa-1x fa-user text-white " id="exit_out" aria-hidden="true"></i>

                </form>
            </div>
        </nav>
    </header>

    <div class="album py-5 bg-white" style="width: 80%; float: right;" id="db_body">
        <div class="container">
            <div class="tab-group">
                <section id="tab1"  style="overflow:auto;" title="数据表格">



        <!--          <a href="#" class="btn btn-primary my-2">Main call to action</a>-->

                <!--          <button class="btn btn-primary my-2" id="add"><i class="fa fa-plus"></i></button>-->

                <div id="toolbar" style="display:none">
                    <button id="add" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
                        <i class="fa fa-plus" aria-hidden="true"></i>Add
                    </button>

                    <button id="remove" class="btn btn-danger" disabled>
                        <i class="fa fa-trash" aria-hidden="true"></i> Delete
                    </button>
                </div>
                <!-- 模态框（Modal） -->
                <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog"
                     aria-labelledby="myLargeModalLabel" id="myModal">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title" id="myModalLabel">编辑报价单</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                        aria-hidden="true">&times;</span></button>

                            </div>
                            <div class="modal-body">
                                <form class="form-horizontal" role="form">
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                                <button type="button" class="btn btn-primary" id="submit-add">确定</button>
                                <button type="button" class="btn btn-primary" id="submit-edit" style="display: none">
                                    确定
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <table id="dataTables" class="table table-striped table-hover"></table>
                </section>
                <section id="tab2"  style="overflow:auto;" title="数据分析">
                    <div id="chart1" style="width: 100%;height:400px;"></div>
                    <div id="chart2" style="width: 60%;height:300px;float:left"></div>
                    <div class="card bg-light" style="width:40%;float:right">
                        <div class="card-header">products list</div>
                        <div class="card-body">
                            <ul class="demo" id="select_products">
                                <li>Lorem ipsum dolor sit amet</li>
                                <li>Consectetur adipiscing elit</li>
                                <li class="checked">Curabitur pulvinar egestas</li>
                                <li>Dui eu porta</li>
                                <li>Integer ut nunc enim</li>
                            </ul>
                        </div>
                    </div>

                </section>
            </div>
        </div>
            </div>


    </div>

</main>
</body>


<script src="static/js/jquery.min.js"></script>
<script src="static/js/popper.min.js"></script>
<script src="static/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/holderjs@2.9.4/holder.js"></script>
<script src="static/js/jquery-accordion-menu.js"></script>
<script src="static/js/jquery-tab.js"></script>
<script src="static/js/simsCheckbox.js"></script>
<script src="static/js/echarts.min.js"></script>
<script src="https://unpkg.com/bootstrap-table@1.15.5/dist/bootstrap-table.min.js"></script>
<script src="https://unpkg.com/tableexport.jquery.plugin/tableExport.min.js"></script>
<script src="https://unpkg.com/bootstrap-table@1.15.5/dist/locale/bootstrap-table-zh-CN.js"></script>
<script src="https://unpkg.com/bootstrap-table@1.15.5/dist/extensions/export/bootstrap-table-export.min.js"></script>
<script src="https://unpkg.com/bootstrap-table/dist/bootstrap-table.min.js"></script>
<script src="https://unpkg.com/bootstrap-table/dist/extensions/editable/bootstrap-table-editable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.1/bootstrap3-editable/js/bootstrap-editable.min.js"></script>
<script src="https://cdn.bootcss.com/toastr.js/latest/js/toastr.min.js"></script>
<script src="https://cdn.bootcss.com/jqueryui/1.12.1/jquery-ui.min.js"></script>
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.js"></script>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js" integrity="sha256-5YmaxAwMjIpMrVlK84Y/+NjCpKnFYa8bWWBbUHSBGfU=" crossorigin="anonymous"></script>-->
<script src="static/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript">
    var url = window.location.href
    var user = ''
    var $table = $('#dataTables')
    var $remove = $('#remove')
    var $add = $('#add')
    var table_name, current_index
    $('#db_body').height('95%')
    $('#db_nav').height('100%')
    var argsIndex = url.split("?user=");
    if (argsIndex.length == 1) {
        var url = 'index.html';
        window.location.href = url;
    } else {
        user = argsIndex[1].replace(/#/, '')
    }
    $('.tab-group').tabify();
    toastr.options = {
        debug: false,
        positionClass: "toast-top-center",
        onclick: null,
        showDuration: "300",
        hideDuration: "100",
        timeOut: "2000",
        extendedTimeOut: "1000",
        showEasing: "swing",
        hideEasing: "linear",
        showMethod: "fadeIn",
        hideMethod: "fadeOut",
    };
    $('#demo-list').html('')
    function showTables(data) {
        var str = "";//定义用于拼接的字符串
        for (var i = 0; i < data.length; i++) {
            str = " <li><a href=\"javascript:;\">" + data[i]['table_name'] + " </a></li>"
            if (i == 0) {
                str = " <li class=\"active\"><a href=\"javascript:;\">" + data[i]['table_name'] + " </a></li>"
            }
            $("#demo-list").append(str);
        }
    }

    $(function () {
        $('#exit_out').click(function () {
            var url = 'index.html';
            window.location.href = url;
        })
        $.ajax({
            type: "post",  //数据提交方式（post/get）
            url: "../backend/select_tables.php",  //提交到的url
            dataType: "json",//返回的数据类型格式
            async: false,
            success: function (res) {
                console.log(res)
                if (res.code == 1) {
                    showTables(res.data)
                    setTimeout(function () {
                        // $('.active').click()
                        $('#jquery-accordion-menu li.active a').click()
                    }, 10)
                } else {

                }
            }
        })
    })

    function format(data) {
        delete data['operator']
        delete data['checked']
        for (var k in data) {
            if (typeof (data[k]) == "undefined" || data[k] == null || data[k] == '') {
                data[k] = 'null'
            }
        }

        for (var i = 0; i < columnsData.length; i++) {
            var dataType = columnsData[i]['DATA_TYPE']
            var reg = RegExp(/(int|float|double|decimal|numeric)/i)
            if (!dataType.match(reg)) {
                var coln = columnsData[i]['COLUMN_NAME']
                var colv = data[coln]
                if (colv != 'null')
                    data[coln] = '"' + colv + '"'
            }
        }

        data['table_name'] = table_name
        return data
    }

    var formatTime = function (fmt) {
        var dateTime = new Date();
        var o = {
            "M+": dateTime.getMonth() + 1, //月份
            "d+": dateTime.getDate(), //日
            "H+": dateTime.getHours(), //小时
            "m+": dateTime.getMinutes(), //分
            "s+": dateTime.getSeconds(), //秒
            "q+": Math.floor((dateTime.getMonth() + 3) / 3), //季度
            "S": dateTime.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) {
            fmt = fmt.replace(RegExp.$1, (dateTime.getFullYear() + "").substr(4 - RegExp.$1.length));
        }
        for (var k in o) {
            if (new RegExp("(" + k + ")").test(fmt)) {
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            }
        }
        return fmt;
    }

    function addlog(logdata) {
        logdata['req'] = 'add_log'
        $.ajax({
            url: '../backend/controller.php',
            data: logdata,
            type: 'POST',
            datatype: 'json',
            success: function (res) {
                console.log(res)
            }
        });
    }

    var columnsData, primaryKey = [], foreignKey = []
    $(function () {
        //列表项背景颜色切换
        $("#demo-list li").click(function () {
            $("#demo-list li.active").removeClass("active")
            $(this).addClass("active");
            table_name = $(this).text();
            $.ajax({
                url: "../backend/select_columns.php?table_name=" + table_name,
                success: function (res) {
                    res = JSON.parse(res);
                    if (res.code == 1) {
                        columnsData = res.data
                        console.log(columnsData)
                        primaryKey = []
                        foreignKey = []
                        for (var i = 0; i < columnsData.length; i++) {
                            if (columnsData[i]['COLUMN_KEY'] == 'PRI') {
                                primaryKey.push({
                                    'column_name': columnsData[i]['COLUMN_NAME'],
                                    'column_type': columnsData[i]['DATA_TYPE']
                                })
                            } else if (columnsData[i]['COLUMN_KEY'] == 'MUL') {
                                foreignKey.push({
                                    'column_name': columnsData[i]['COLUMN_NAME'],
                                    'referenced_table_name': columnsData[i]['REFERENCED_TABLE_NAME'],
                                    'referenced_column_name': columnsData[i]['REFERENCED_COLUMN_NAME']
                                })
                            }
                        }
                    }
                }

            })

            $.ajax({
                url: "../backend/select.php?table_name=" + table_name,
                //data是成功返回的json串
                success: function (res) {
                    res = JSON.parse(res);
                    if (res.code == 1) {
                        var data = res.data
                        var key = []
                        for (var k in data[0]) {
                            key.push(k)
                        }
                        setTimeout(function () {
                            renderTable(key, data)
                        }, 200)
                    }
                },


            })
        })
    })

    function renderTable(key, data) {
        var l = columnsData.length
        var columns = []
        columns.push({
            field: 'checked',
            checkbox: true,
            align: 'center',
            valign: 'middle'
        })
        for (var i = 0; i < l; i++) {
            columns.push({
                field: columnsData[i]['COLUMN_NAME'],
                title: columnsData[i]['COLUMN_NAME'],
                align: 'center',
                sortable: true
            })
        }
        columns.push({
            field: 'operator',
            title: 'operator',
            align: 'center',
            valign: 'middle',
            width: '10%',
            class: 'operator',
            // visible: false,
            formatter: function (value, row, index) {
                // var sid_code = base64encode(row.sid + '');   //  sid 加密处理
                // alert(sid_code);
                var str = '<a id="rowedit" href="javascript:void(0)" title="update">' +
                    '<i class="fa fa-pencil" style="color:darkslategrey;" aria-hidden="true"></i> ' +
                    '</a>' +
                    '<a id="rowdelete" href="javascript:void(0)" title="delete">' +
                    '<i class="fa fa-minus" style="color:red;" aria-hidden="true"></i> ' +
                    '</a>'
                console.log(table_name)
                if ($.trim(table_name) == "products") {
                    str += '<a id="report" href="javascript:void(0)" title="report">' +
                        '<i  class="fa fa-book" style="color:peru;" aria-hidden="true"></i> ' +
                        '</a>'
                }
                return str;
            },
            events: {
                'click #rowedit': function (e, value, row, index) {
                    current_index = index
                    var data = Object.assign({}, row)
                    data = format(data)
                    console.log(data)
                    var content = "<form class=\"form-horizontal\">"
                    for (var i = 0; i < columnsData.length; i++) {
                        var colt = columnsData[i]['DATA_TYPE']
                        var coln = columnsData[i]['COLUMN_NAME']
                        var cold = columnsData[i]['COLUMN_DEFAULT']
                        var datat = columnsData[i]['COLUMN_TYPE']
                        content += "<div class=\"form-group row\">\n" +
                            "                                      <label for=\"" + coln + "\" class=\"col-sm-2 control-label\">" + coln + "</label>\n" +
                            "                                      <div class=\"col-sm-8\">\n" +
                            "                                          <input type=\"text\" style=\"display:inline-block;width:95%\" placeholder=\"" + cold + "\" class=\"form-control\" id=\"" + coln + "\" value=\"" + data[coln].replace(/"/g, "") + "\">\n" +
                            '<a style=\"display:inline-block;\" href="javascript:void(0)" title="' + datat + '">' +
                            '<i class="fa fa-question-circle" aria-hidden="true"></i> ' +
                            '</a>' +
                            "                                      </div>\n" +
                            "                                  </div>"
                        if (colt.toLowerCase() == 'date') {
                            content += " <script type=\"text/javascript\">\n" +
                                "    $('#" + coln + "').datetimepicker({\n" +
                                "       format:'yyyy-mm-dd',\n" +
                                "       autoclose: true\n" +
                                "    });\n<\/script>"
                        } else if (colt.toLowerCase() == 'time') {
                            content += " <script type=\"text/javascript\">\n" +
                                "    $('#" + coln + "').datetimepicker({\n" +
                                "       format:'hh:ii:ss',\n" +
                                "       autoclose: true\n" +
                                "    });\n<\/script>"
                        } else if (colt.toLowerCase() == 'datetime') {
                            content += " <script type=\"text/javascript\">\n" +
                                "    $('#" + coln + "').datetimepicker({\n" +
                                "       format:'yyyy-mm-dd hh:ii:ss',\n" +
                                "       autoclose: true\n" +
                                "    });\n<\/script>"
                        }
                    }
                    content += "</form>"
                    content += "<script type=\"text/javascript\">\n"
                    for (var i = 0; i < primaryKey.length; i++) {
                        content += "$('#" + primaryKey[i]['column_name'] + "').css('color','red')\n"
                    }
                    console.log(foreignKey)
                    for (var i = 0; i < foreignKey.length; i++) {
                        var key = foreignKey[i]
                        $.ajax({
                            url: "../backend/select.php?table_name=" + key['referenced_table_name'],
                            async: false,
                            //data是成功返回的json串
                            success: function (res) {
                                res = JSON.parse(res);
                                if (res.code == 1) {
                                    var coldata = res.data
                                    var optStr = '<select style="display:inline-block;width:95%" class="form-control" id="' + key['column_name'] + '">'
                                    optStr += "<option><\/option>"
                                    for (var i = 0; i < coldata.length; i++) {
                                        if (coldata[i][key['referenced_column_name']] == data[key['column_name']].replace(/"/g, ""))
                                            optStr += "<option selected = \"selected\">" + coldata[i][key['referenced_column_name']] + "<\/option>"
                                        else {
                                            optStr += "<option>" + coldata[i][key['referenced_column_name']] + "<\/option>"
                                        }
                                    }
                                    console.log(optStr)
                                    content += "$('#" + key['column_name'] + "').replaceWith('" + optStr + "')\n"
                                }
                            }
                        })
                    }
                    content += "<\/script>"


                    $('#myModal').modal().find('.modal-title').text('编辑')
                    $('#myModal').modal().find('.modal-body').html(content)
                    $('#myModal').modal().find('#submit-add').hide()
                    $('#myModal').modal().find('#submit-edit').show()
                },
                'click #rowdelete': function (e, value, row, index) {
                    var data = Object.assign({}, row)
                    data = format(data)
                    for (var k in data) {
                        if (data[k] == "null") {
                            delete data[k]
                        }
                    }
                    console.log(data)
                    $.ajax({
                        url: '../backend/delete.php',
                        data: data,
                        type: 'POST',
                        datatype: 'json',
                        success: function (res) {

                            res = JSON.parse(res);
                            console.log(res.message)

                            if (res.code == 1) {
                                toastr.error(res.message, 'Error')
                            } else {
                                toastr.success(res.message, 'success');
                                $table.bootstrapTable('remove', {
                                    field: primaryKey[0]['column_name'],
                                    values: data[primaryKey[0]['column_name']]
                                })
                                $remove.prop('disabled', true)
                            }
                        }


                    });
                },
                'click #report': function (e, value, row, index) {
                    var row = Object.assign({}, row)
                    var content = ''
                    content += '<p> 商品编号：' + row['pid'] + '</p>'
                    content += '<p> 商品名字：' + row['pname'] + '</p>'
                    content += '<p> 销售情况：</p>'
                    content += '<table id="saleTable" class="table"></table><br>'
                    content += '<h5 class="page-header"></h5>'
                    content += '<table id="infoTable" class="table"></table>'
                    var monthSale = []
                    var redata
                    $.ajax({
                        url: "../backend/controller.php",
                        data: {'req': 'report', 'pid': row['pid']},
                        async: false,
                        type: 'post',
                        //data是成功返回的json串
                        success: function (res) {
                            console.log(res)
                            res = JSON.parse(res);

                            if (res.code == 1) {
                                redata = res.data
                                console.log(redata)
                                for (var i = 0; i < redata.length; i++) {
                                    var date = new Date(redata[i]['ptime'])
                                    console.log(date)
                                    var month = date.getMonth()
                                    var year = date.getFullYear()
                                    var flag = 0
                                    for (var j = 0; j < monthSale.length; j++) {
                                        if (monthSale[j]['year'] == year && monthSale[j]['month'] == month) {
                                            flag = 1
                                            monthSale[j]['total_sale'] += parseFloat(redata[i]['qty'])
                                            monthSale[j]['total_price'] += parseFloat(redata[i]['total_price'])
                                            break
                                        }
                                    }
                                    if (flag == 0) {
                                        monthSale.push({
                                            year: year,
                                            month: month,
                                            total_sale: parseFloat(redata[i]['qty']),
                                            total_price: parseFloat(redata[i]['total_price'])
                                        })
                                    }
                                }

                            }
                        }
                    })

                    var monthName = ['Jan.', 'Feb.', 'Mar.', 'Apr.', 'May.', 'Jun.', 'Jul.', 'Aug.', 'Sept.', 'Oct.', 'Nov.', 'Dec.']
                    for (var i = 0; i < monthSale.length; i++) {
                        monthSale[i]['avg_price'] = monthSale[i]['total_price'] / monthSale[i]['total_sale']
                        monthSale[i]['month'] = monthName[monthSale[i]['month']]
                    }

                    var reportColumns = [
                        {field: 'month', title: 'month', align: 'center', sortable: true},
                        {field: 'year', title: 'year', align: 'center', sortable: true},
                        {field: 'total_sale', title: 'total_sale', align: 'center', sortable: true},
                        {field: 'total_price', title: 'total_price', align: 'center', sortable: true},
                        {field: 'avg_price', title: 'avg_price', align: 'center', sortable: true},
                        {
                            field: 'operator',
                            title: 'operator',
                            align: 'center',
                            valign: 'middle',
                            width: '10%',
                            class: 'operator',
                            formatter: '<a id="show" href="javascript:void(0)" title="show">' +
                                '<i  class="fa fa-eye" style="color:peachpuff;" aria-hidden="true"></i> ' +
                                '</a>' +
                                '<a id="hide" href="javascript:void(0)" style="display: none" title="hide">' +
                                '<i  class="fa fa-eye-slash" style="color:peachpuff" aria-hidden="true"></i> ' +
                                '</a>',
                            events: "window.operateEvents"
                        }
                    ]
                    window.operateEvents = {
                        'click #show': function (e, value, row, index) {
                            var showData = []
                            var selData = Object.assign({}, row)
                            var year = selData['year']
                            var month = monthName.indexOf(selData['month'])
                            for (var i = 0; i < redata.length; i++) {
                                var date = new Date(redata[i]['ptime'])
                                if (date.getFullYear() == year && date.getMonth() == month) {
                                    showData.push(redata[i])
                                }
                            }
                            var showColumn = []
                            for (var k in redata[0]) {
                                showColumn.push({field: k, title: k, align: 'center', sortable: true})
                            }
                            console.log(showColumn)
                            $('#infoTable').bootstrapTable("destroy").bootstrapTable({
                                columns: showColumn,
                                data: showData
                            })
                            console.log($('#saleTable tr[data-index=' + index + ']'))
                            $('#saleTable tr[data-index=' + index + '] #show').hide()
                            $('#saleTable tr[data-index=' + index + '] #hide').show()
                        },
                        'click #hide': function (e, value, row, index) {

                            $('#infoTable').bootstrapTable("destroy")
                            $('#saleTable tr[data-index=' + index + '] #show').show()
                            $('#saleTable tr[data-index=' + index + '] #hide').hide()
                        }
                    }
                    content += ' <script type="text/javascript">'
                    content += '$("#saleTable").bootstrapTable("destroy").bootstrapTable({'
                    content += '    columns:' + JSON.stringify(reportColumns) + ','
                    content += '    data:' + JSON.stringify(monthSale)
                    content += '})'
                    content += '<\/script>'
                    $('#myModal').modal().find('.modal-title').text('查看报告')
                    $('#myModal').modal().find('.modal-body').html(content)
                    $('#myModal').modal().find('#submit-add').hide()
                    $('#myModal').modal().find('#submit-edit').hide()

                }
            }

        })
        console.log(columns)
        console.log(data)
        $table.bootstrapTable('destroy').bootstrapTable({
            toolbar: '#toolbar',                //工具按钮用哪个容器
            striped: true,                      //是否显示行间隔色
            cache: true,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
            pagination: true,                   //是否显示分页（*）
            sortable: true,                     //是否启用排序
            sortOrder: "asc",                   //排序方式
            sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
            pageNumber: 1,                       //初始化加载第一页，默认第一页
            pageSize: 10,                       //每页的记录行数（*）
            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
            search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
            strictSearch: false,
            showColumns: true,                  //是否显示所有的列
            showRefresh: true,                  //是否显示刷新按钮
            minimumCountColumns: 0,             //最少允许的列数
            clickToSelect: true,                //是否启用点击选中行
            width: '80%',
            // height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
            showToggle: true,                    //是否显示详细视图和列表视图的切换按钮
            cardView: false,                    //是否显示详细视图
            detailView: false,                   //是否显示父子表
            showExport: true,
            showPaginationSwitch: true,
            searchOnEnterKey: true,
            undefinedText: '',
            columns: columns,
            data: data
        });
        $('#toolbar').show()
        $('.tab-group ul li').first().click()
        console.log($('.tab-group ul li').first().text())
    }

    $table.on('check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table', function () {
        if (primaryKey.length == 1) {
            $remove.prop('disabled', !$table.bootstrapTable('getSelections').length)
        }

    })
    $('#analysis').click(function () {
        var content = '<div id="main" style="width: 600px;height:400px;"></div>'
        content += '<script type="text/javascript">\n' +
            '        // 基于准备好的dom，初始化echarts实例\n' +
            '        var myChart = echarts.init(document.getElementById(\'main\'));\n' +
            '\n' +
            '        // 指定图表的配置项和数据\n' +
            '        var option = {\n' +
            '            title: {\n' +
            '                text: \'ECharts 入门示例\'\n' +
            '            },\n' +
            ' tooltip: {},\n' +
            '            legend: {\n' +
            '                data:[\'总销量\',\'销售总价\']\n' +
            '            },\n' +
            '            xAxis: {\n' +
            '                data: ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]\n' +
            '            },\n' +
            '            yAxis: {},\n' +
            '            series: [{\n' +
            '                name: \'销量\',\n' +
            '                type: \'bar\',\n' +
            '                data: [5, 20, 36, 10, 10, 20]\n' +
            '            }]\n' +
            '        };\n' +
            '\n' +
            '        // 使用刚指定的配置项和数据显示图表。\n' +
            '        myChart.setOption(option);\n' +
            '    <\/script>'
        $('#myModal').modal().find('.modal-title').text("数据分析")
        $('#myModal').modal().find('.modal-body').html(content)
        $('#myModal').modal().find('#submit-add').hide()
        $('#myModal').modal().find('#submit-edit').hide()
        $('#myModal').draggable();
    })

    $remove.click(function () {
        var val = $.map($table.bootstrapTable('getSelections'), function (row) {
            var reg = RegExp(/(int|float|double|decimal|numeric)/i)
            if (!primaryKey[0]['column_type'].match(reg)) {
                return '"' + row[primaryKey[0]['column_name']] + '"'
            } else return row[primaryKey[0]['column_name']]

        })
        console.log(val)
        var data = {}
        data['table_name'] = table_name
        data['option'] = primaryKey[0]['column_name'] + ' in (' + val.join(', ') + ')'
        $.ajax({
            url: '../backend/deleteMany.php',
            data: data,
            type: 'POST',
            datatype: 'json',
            success: function (res) {
                res = JSON.parse(res);
                console.log(res.message)
                if (res.code == 1) {
                    toastr.error(res.message, 'Error')
                } else {
                    toastr.success(res.message, 'success')
                    for (var i = 0; i < val.length; i++) {
                        val[i] = val[i].replace(/"/g, '')
                    }
                    $table.bootstrapTable('remove', {
                        field: primaryKey[0]['column_name'],
                        values: val
                    })
                    $remove.prop('disabled', true)
                }
            }


        });
    })
    $add.click(function () {
        var content = "<form class=\"form-horizontal\">"
        for (var i = 0; i < columnsData.length; i++) {
            var colt = columnsData[i]['DATA_TYPE']
            if (colt.toLowerCase() == 'datetime') continue
            var coln = columnsData[i]['COLUMN_NAME']
            if (coln.indexOf('total') != -1) continue
            var cold = columnsData[i]['COLUMN_DEFAULT']
            var datat = columnsData[i]['COLUMN_TYPE']
            content += "<div class=\"form-group row\">\n" +
                "                                      <label for=\"" + coln + "\" class=\"col-sm-2 control-label\">" + coln + "</label>\n" +
                "                                      <div class=\"col-sm-8\">\n" +
                "                                          <input type=\"text\" style=\"display:inline-block;width:95%\" placeholder=\"" + cold + "\" class=\"form-control\" id=\"" + coln + "\">\n" +
                '<a style=\"display:inline-block;\" href="javascript:void(0)" title="' + datat + '">' +
                '<i class="fa fa-question-circle" aria-hidden="true"></i> ' +
                '</a>' +
                "                                      </div>\n" +
                "                                  </div>"
            if (colt.toLowerCase() == 'date') {
                content += " <script type=\"text/javascript\">\n" +
                    "    $('#" + coln + "').datetimepicker({\n" +
                    "       format:'yyyy-mm-dd',\n" +
                    "       autoclose: true\n" +
                    "    });\n<\/script>"
            } else if (colt.toLowerCase() == 'time') {
                content += " <script type=\"text/javascript\">\n" +
                    "    $('#" + coln + "').datetimepicker({\n" +
                    "       format:'hh:ii:ss',\n" +
                    "       autoclose: true\n" +
                    "    });\n<\/script>"
            } else if (colt.toLowerCase() == 'datetime') {
                content += " <script type=\"text/javascript\">\n" +
                    "    $('#" + coln + "').datetimepicker({\n" +
                    "       format:'yyyy-mm-dd hh:ii:ss',\n" +
                    "       autoclose: true\n" +
                    "    });\n<\/script>"
            }

        }
        content += "</form>"
        content += "<script type=\"text/javascript\">\n"
        for (var i = 0; i < primaryKey.length; i++) {
            content += "$('#" + primaryKey[i]['column_name'] + "').css('color','red')\n"
        }
        for (var i = 0; i < foreignKey.length; i++) {
            var key = foreignKey[i]
            $.ajax({
                url: "../backend/select.php?table_name=" + key['referenced_table_name'],
                async: false,
                //data是成功返回的json串
                success: function (res) {
                    res = JSON.parse(res);
                    if (res.code == 1) {
                        var coldata = res.data
                        var optStr = '<select style="display:inline-block;width:95%" class="form-control" id="' + key['column_name'] + '">'
                        optStr += "<option>null<\/option>"
                        for (var i = 0; i < coldata.length; i++) {
                            optStr += "<option>" + coldata[i][key['referenced_column_name']] + "<\/option>"
                        }
                        console.log(optStr)
                        content += "$('#" + key['column_name'] + "').replaceWith('" + optStr + "')\n"
                    }
                }
            })
        }
        content += "<\/script>"
        $('#myModal').modal().find('.modal-title').text("新增")
        $('#myModal').modal().find('.modal-body').html(content)
        $('#myModal').modal().find('#submit-add').show()
        $('#myModal').modal().find('#submit-edit').hide()
    })
    $('#submit-add').click(function () {
        var data = {}
        for (var i = 0; i < columnsData.length; i++) {
            if (columnsData[i]['DATA_TYPE'].toLowerCase() == 'datetime' && $.trim(table_name) != 'purchases') {
                data[columnsData[i]['COLUMN_NAME']] = formatTime('yyyy-MM-dd HH:mm:ss')
            } else {
                data[columnsData[i]['COLUMN_NAME']] = $.trim($('#' + columnsData[i]['COLUMN_NAME']).val());
            }

        }
        data = format(data)
        for (var k in data) {
            if (data[k] == "null") {
                delete data[k]
            }
        }

        if ($.trim(table_name) == 'purchases') {
            delete data['table_name']
            data['req'] = 'add_purchase'
            console.log(data)
            $.ajax({
                url: '../backend/controller.php',
                data: data,
                type: 'POST',
                async: false,
                datatype: 'json',
                success: function (res) {

                    console.log(res)
                    addRow(res)
                }
            })
        } else {
            $.ajax({
                url: '../backend/insert.php',
                data: data,
                type: 'POST',
                async: false,
                datatype: 'json',
                success: function (res) {
                    res = JSON.parse(res)
                    if(res.code=0){
                        toastr.error(res.message,'error')
                    }else{
                        toastr.success(res.message,'success')
                        $('#myModal').modal('hide')
                        console.log($('#jquery-accordion-menu li.active a'))
                        $('#jquery-accordion-menu li.active a').click()
                    }
                }
            });
        }
    })

    function addRow(res) {
        res = JSON.parse(res);
        console.log(res.message)
        if (res.code == 1) {
            toastr.error('由于内部原因，该次购买失败', '错误')
        } else {
            var message = res.message
            var str = message.split('warn: ')
            toastr.success(str[0], '成功')
            if (str.length > 1) {
                var str1 = str[1].split('tips: ')
                setTimeout(function () {
                    toastr.warning(str1[0], '警告')
                }, 500)
                setTimeout(function () {
                    toastr.success(str1[1])
                }, 1000)

            }
            $('#myModal').modal('hide')
            $('#jquery-accordion-menu li.active a').click()
        }
    }

    $('#submit-edit').click(function () {
        var data = {}
        for (var i = 0; i < columnsData.length; i++) {
            data[columnsData[i]['COLUMN_NAME']] = $.trim($('#' + columnsData[i]['COLUMN_NAME']).val());
        }
        data = format(data)
        for (var k in data) {
            if (data[k] == "null") {
                delete data[k]
            }
        }
        data['option'] = primaryKey[0]['column_name'] + "=" + data[primaryKey[0]['column_name']]
        console.log(data)
        $.ajax({
            url: '../backend/update.php',
            data: data,
            type: 'POST',
            datatype: 'json',
            success: function (res) {
                res = JSON.parse(res);

                console.log(res.message)
                if (res.code == 1) {
                    toastr.error(res.message, 'Error')
                } else {
                    toastr.success(res.message, 'success');
                    var logdata = {}
                    logdata['operation'] = 'update'
                    logdata['tables_name'] = table_name
                    logdata['key_value'] = data[primaryKey[0]['column_name']]
                    addlog(logdata)
                    for (var k in data) {
                        data[k] = data[k].replace(/"/g, "")
                    }
                    delete data['table_name']
                    delete data['option']
                    $table.bootstrapTable('updateRow', {
                        index: current_index,
                        row: data
                    })

                    $('#myModal').modal('hide')
                }

            }


        });
    })
    $(window).resize(function () {          //当浏览器大小变化时
        $('#db_body').height('95%')
        $('#db_nav').height('100%')
    });
    // 基于准备好的dom，初始化echarts实例
    var allproducts;
    $.ajax({
        url: '../backend/select.php?table_name=products',
        async:false,
        success: function (res) {
            res = JSON.parse(res);
            allproducts = res.data
        }
    })
    var products_name = []
    var products_num = []
    var products_price = []
    for(var i=0;i<allproducts.length;i++){
        products_name.push(allproducts[i]['pname'])
        $.ajax({
            url: "../backend/controller.php",
            data:{'req':'more_operation','query':'select sum(qty) qty, sum(total_price) total_price from purchases where pid="'+allproducts[i]['pid']+'"'},
            async:false,
            type:'post',
            success: function (res) {
                res = JSON.parse(res);
                var data = res.data
                if(data.length>0){
                    products_num.push(data[0]['qty'])
                    products_price.push(data[0]['total_price'])
                }else{
                    products_num.push(0)
                    products_price.push(0)
                }
            }
        })
    }



    var myChart1 = echarts.init(document.getElementById('chart1'));
    var myChart2 = echarts.init(document.getElementById('chart2'));
    // 指定图表的配置项和数据
    var option1 = {
        //标题，每个图表最多仅有一个标题控件，每个标题控件可设主副标题  
        title: {
            //主标题文本，'\n'指定换行  
            text: '总体产品比较',
            //水平安放位置，默认为左侧，可选为：'center' | 'left' | 'right' | {number}（x坐标，单位px）  
            x: 'left',
            //垂直安放位置，默认为全图顶端，可选为：'top' | 'bottom' | 'center' | {number}（y坐标，单位px）  
            y: 'top'
        },
        //提示框，鼠标悬浮交互时的信息提示  
        tooltip: {
            //触发类型，默认（'item'）数据触发，可选为：'item' | 'axis'  
            trigger: 'axis'
        },
        //图例，每个图表最多仅有一个图例  
        legend: {
            //显示策略，可选为：true（显示） | false（隐藏），默认值为true  
            show: true,
            //水平安放位置，默认为全图居中，可选为：'center' | 'left' | 'right' | {number}（x坐标，单位px）  
            x: 'center',
            //垂直安放位置，默认为全图顶端，可选为：'top' | 'bottom' | 'center' | {number}（y坐标，单位px）  
            y: 'top',
            //legend的data: 用于设置图例，data内的字符串数组需要与sereis数组内每一个series的name值对应  
            data: ['销售总量','销售总价']
        },
        //工具箱，每个图表最多仅有一个工具箱  
        toolbox: {
            //显示策略，可选为：true（显示） | false（隐藏），默认值为false  
            show: true,
            //启用功能，目前支持feature，工具箱自定义功能回调处理  
            feature: {
                //辅助线标志  
                mark: {show: true},
                //dataZoom，框选区域缩放，自动与存在的dataZoom控件同步，分别是启用，缩放后退  
                dataZoom: {
                    show: true,
                    title: {
                        dataZoom: '区域缩放',
                        dataZoomReset: '区域缩放后退'
                    }
                },
                //数据视图，打开数据视图，可设置更多属性,readOnly 默认数据视图为只读(即值为true)，可指定readOnly为false打开编辑功能  
                dataView: {show: true, readOnly: true},
                //magicType，动态类型切换，支持直角系下的折线图、柱状图、堆积、平铺转换  
                magicType: {show: true, type: ['line', 'bar']},
                //restore，还原，复位原始图表  
                restore: {show: true},
                //saveAsImage，保存图片（IE8-不支持）,图片类型默认为'png'  
                saveAsImage: {show: true}
            }
        },
        //是否启用拖拽重计算特性，默认关闭(即值为false)  
        calculable: true,
        //直角坐标系中横轴数组，数组中每一项代表一条横轴坐标轴，仅有一条时可省略数值  
        //横轴通常为类目型，但条形图时则横轴为数值型，散点图时则横纵均为数值型  
        xAxis: [
            {
                //显示策略，可选为：true（显示） | false（隐藏），默认值为true  
                show: true,
                //坐标轴类型，横轴默认为类目型'category'  
                type: 'category',
                //类目型坐标轴文本标签数组，指定label内容。 数组项通常为文本，'\n'指定换行  
                data: products_name
            }
        ],
        //直角坐标系中纵轴数组，数组中每一项代表一条纵轴坐标轴，仅有一条时可省略数值  
        //纵轴通常为数值型，但条形图时则纵轴为类目型  
        yAxis: [
            {
                //显示策略，可选为：true（显示） | false（隐藏），默认值为true  
                show: true,
                //坐标轴类型，纵轴默认为数值型'value'  
                type: 'value',
                //分隔区域，默认不显示  
                splitArea: {show: true}
            }
        ],

        //sereis的数据: 用于设置图表数据之用。series是一个对象嵌套的结构；对象内包含对象  
        series: [
            {
                //系列名称，如果启用legend，该值将被legend.data索引相关  
                name: '销售总量',
                //图表类型，必要参数！如为空或不支持类型，则该系列数据不被显示。  
                type: 'bar',
                //系列中的数据内容数组，折线图以及柱状图时数组长度等于所使用类目轴文本标签数组axis.data的长度，并且他们间是一一对应的。数组项通常为数值  
                data: products_num,
                //系列中的数据标注内容  
                markPoint: {
                    data: [
                        {type: 'max', name: '最大值'},
                        {type: 'min', name: '最小值'}
                    ]
                },
                //系列中的数据标线内容  
                markLine: {
                    data: [
                        {type: 'average', name: '平均值'}
                    ]
                }
            },
            {
                //系列名称，如果启用legend，该值将被legend.data索引相关  
                name: '销售总价',
                //图表类型，必要参数！如为空或不支持类型，则该系列数据不被显示。  
                type: 'bar',
                //系列中的数据内容数组，折线图以及柱状图时数组长度等于所使用类目轴文本标签数组axis.data的长度，并且他们间是一一对应的。数组项通常为数值  
                data: products_price,
                //系列中的数据标注内容  
                markPoint: {
                    data: [
                        {type: 'max', name: '最大值'},
                        {type: 'min', name: '最小值'}
                    ]
                },
                //系列中的数据标线内容  
                markLine: {
                    data: [
                        {type: 'average', name: '平均值'}
                    ]
                }
            }
        ]
    };  
    // 使用刚指定的配置项和数据显示图表。
    myChart1.setOption(option1);
    $('#select_products').html('')
    for(var i=0;i<products_name.length;i++){
        $('#select_products').append(' <li pid="'+allproducts[i]['pid']+'">'+products_name[i]+'</li>')
    }
    $("#select_products").simsCheckbox({
        "btnStyle":'radio',
        'titleIcon':'circle-o',
        "checkedClass":'btn-warning',
        'ifChecked':function(e){
            var pid = $('.sims-selectable.btn-warning').attr('pid')
            var month = ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月']
            var month_num = new Array(12).fill(0)
            var month_price = new Array(12).fill(0)
            $.ajax({
                url: "../backend/controller.php",
                data:{'req':'more_operation','query':'select month,sum(qty) qty,sum(total_price) total_price from (select MONTH(ptime) month, qty, total_price from purchases where pid="'+pid+'") m group by month'},
                async:false,
                type:'post',
                success: function (res) {
                    res = JSON.parse(res);
                    var data = res.data
                    console.log(res)
                    for(var i=0;i<data.length;i++){
                        var m = data[i]['month']-1
                        month_num[m] = data[i]['qty']
                        month_price[m] = data[i]['total_price']
                    }
                }
            })
            var option2 = {
                //标题，每个图表最多仅有一个标题控件，每个标题控件可设主副标题  
                title: {
                    //主标题文本，'\n'指定换行  
                    text: '各个产品分析',
                    //水平安放位置，默认为左侧，可选为：'center' | 'left' | 'right' | {number}（x坐标，单位px）  
                    x: 'left',
                    //垂直安放位置，默认为全图顶端，可选为：'top' | 'bottom' | 'center' | {number}（y坐标，单位px）  
                    y: 'top'
                },
                //提示框，鼠标悬浮交互时的信息提示  
                tooltip: {
                    //触发类型，默认（'item'）数据触发，可选为：'item' | 'axis'  
                    trigger: 'axis'
                },
                //图例，每个图表最多仅有一个图例  
                legend: {
                    //显示策略，可选为：true（显示） | false（隐藏），默认值为true  
                    show: true,
                    //水平安放位置，默认为全图居中，可选为：'center' | 'left' | 'right' | {number}（x坐标，单位px）  
                    x: 'center',
                    //垂直安放位置，默认为全图顶端，可选为：'top' | 'bottom' | 'center' | {number}（y坐标，单位px）  
                    y: 'top',
                    //legend的data: 用于设置图例，data内的字符串数组需要与sereis数组内每一个series的name值对应  
                    data: ['各月销售量','各月销售价格']
                },
                //工具箱，每个图表最多仅有一个工具箱  
                toolbox: {
                    //显示策略，可选为：true（显示） | false（隐藏），默认值为false  
                    show: true,
                    //启用功能，目前支持feature，工具箱自定义功能回调处理  
                    feature: {
                        //辅助线标志  
                        mark: {show: true},
                        //dataZoom，框选区域缩放，自动与存在的dataZoom控件同步，分别是启用，缩放后退  
                        dataZoom: {
                            show: true,
                            title: {
                                dataZoom: '区域缩放',
                                dataZoomReset: '区域缩放后退'
                            }
                        },
                        //数据视图，打开数据视图，可设置更多属性,readOnly 默认数据视图为只读(即值为true)，可指定readOnly为false打开编辑功能  
                        dataView: {show: true, readOnly: true},
                        //magicType，动态类型切换，支持直角系下的折线图、柱状图、堆积、平铺转换  
                        magicType: {show: true, type: ['line', 'bar']},
                        //restore，还原，复位原始图表  
                        restore: {show: true},
                        //saveAsImage，保存图片（IE8-不支持）,图片类型默认为'png'  
                        saveAsImage: {show: true}
                    }
                },
                //是否启用拖拽重计算特性，默认关闭(即值为false)  
                calculable: true,
                //直角坐标系中横轴数组，数组中每一项代表一条横轴坐标轴，仅有一条时可省略数值  
                //横轴通常为类目型，但条形图时则横轴为数值型，散点图时则横纵均为数值型  
                xAxis: [
                    {
                        //显示策略，可选为：true（显示） | false（隐藏），默认值为true  
                        show: true,
                        //坐标轴类型，横轴默认为类目型'category'  
                        type: 'category',
                        //类目型坐标轴文本标签数组，指定label内容。 数组项通常为文本，'\n'指定换行  
                        data: month
                    }
                ],
                //直角坐标系中纵轴数组，数组中每一项代表一条纵轴坐标轴，仅有一条时可省略数值  
                //纵轴通常为数值型，但条形图时则纵轴为类目型  
                yAxis: [
                    {
                        //显示策略，可选为：true（显示） | false（隐藏），默认值为true  
                        show: true,
                        //坐标轴类型，纵轴默认为数值型'value'  
                        type: 'value',
                        //分隔区域，默认不显示  
                        splitArea: {show: true}
                    }
                ],

                //sereis的数据: 用于设置图表数据之用。series是一个对象嵌套的结构；对象内包含对象  
                series: [
                    {
                        //系列名称，如果启用legend，该值将被legend.data索引相关  
                        name: '各月销售量',
                        //图表类型，必要参数！如为空或不支持类型，则该系列数据不被显示。  
                        type: 'bar',
                        //系列中的数据内容数组，折线图以及柱状图时数组长度等于所使用类目轴文本标签数组axis.data的长度，并且他们间是一一对应的。数组项通常为数值  
                        data: month_num,

                    },
                    {
                        //系列名称，如果启用legend，该值将被legend.data索引相关  
                        name: '各月销售价格',
                        //图表类型，必要参数！如为空或不支持类型，则该系列数据不被显示。  
                        type: 'bar',
                        //系列中的数据内容数组，折线图以及柱状图时数组长度等于所使用类目轴文本标签数组axis.data的长度，并且他们间是一一对应的。数组项通常为数值  
                        data: month_price,


                    }
                ]
            };

            myChart2.setOption(option2)
        }
    });


</script>
</html>